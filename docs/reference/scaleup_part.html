<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Scale segmented participation counts to total (if needed) — scaleup_part • salic</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Scale segmented participation counts to total (if needed) — scaleup_part" />

<meta property="og:description" content="This scaling accounts for missing values in segments, scaling up all counts
to ensure the sum matches the total count. It expects 2 tables as input, both
produced by est_part. If no scaling is needed (i.e., sum(part_segment$part)
== sum(part_total$part)) the function will simply return the input df." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">salic</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/salic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/southwick-associates/salic">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Scale segmented participation counts to total (if needed)</h1>
    <small class="dont-index">Source: <a href='https://github.com/southwick-associates/salic/blob/master/R/dashboard.R'><code>R/dashboard.R</code></a></small>
    <div class="hidden name"><code>scaleup_part.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This scaling accounts for missing values in segments, scaling up all counts
to ensure the sum matches the total count. It expects 2 tables as input, both
produced by <code><a href='est_part.html'>est_part</a></code>. If no scaling is needed (i.e., sum(part_segment$part)
== sum(part_total$part)) the function will simply return the input df.</p>
    
    </div>

    <pre class="usage"><span class='fu'>scaleup_part</span>(<span class='no'>part_segment</span>, <span class='no'>part_total</span>, <span class='kw'>test_threshold</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>show_test_stat</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>outvar</span> <span class='kw'>=</span> <span class='st'>"participants"</span>)

<span class='fu'>scaleup_recruit</span>(<span class='no'>part_segment</span>, <span class='no'>part_total</span>, <span class='kw'>test_threshold</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>show_test_stat</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>outvar</span> <span class='kw'>=</span> <span class='st'>"recruits"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>part_segment</th>
      <td><p>data frame: A segmented  participation table
produced by <code><a href='est_part.html'>est_part</a></code> (e.g., with segment argument set to "res")</p></td>
    </tr>
    <tr>
      <th>part_total</th>
      <td><p>data frame: An overall participation table produced by
<code><a href='est_part.html'>est_part</a></code></p></td>
    </tr>
    <tr>
      <th>test_threshold</th>
      <td><p>numeric: threshold in whole number percentage points 
which defines the upper limit of acceptable proportion of missing values for 
the segment. The function will stop with an error if this threshold
is exceeded. Relaxing the threshold can allow the check to pass, but use this
with caution since a high percentage of missing values might suggests that 
the breakouts aren't representative (e.g., if not missing at random).</p></td>
    </tr>
    <tr>
      <th>show_test_stat</th>
      <td><p>logical: If TRUE, the output table will include
a variable holding the test statistic for each row.</p></td>
    </tr>
    <tr>
      <th>outvar</th>
      <td><p>character: name of variable that stores metric</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Salic Function Reference: <code><a href='salic.html'>salic</a></code></p>
<p>Other dashboard functions: <code><a href='check_threshold.html'>check_threshold</a></code>,
  <code><a href='est_churn.html'>est_churn</a></code>, <code><a href='est_part.html'>est_part</a></code>,
  <code><a href='format_result.html'>format_result</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>library</span>(<span class='no'>dplyr</span>)
<span class='fu'>data</span>(<span class='no'>history</span>)
<span class='no'>history</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='label_categories.html'>label_categories</a></span>(<span class='no'>history</span>)

<span class='co'># demonstrate the need for scaling</span>
<span class='no'>part_total</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='est_part.html'>est_part</a></span>(<span class='no'>history</span>)
<span class='no'>part_segment</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='est_part.html'>est_part</a></span>(<span class='no'>history</span>, <span class='st'>"sex"</span>, <span class='kw'>test_threshold</span> <span class='kw'>=</span> <span class='fl'>40</span>)
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/join.html'>left_join</a></span>(
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span>(<span class='no'>part_total</span>, <span class='no'>year</span>, <span class='kw'>part_tot</span> <span class='kw'>=</span> <span class='no'>participants</span>),
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>part_segment</span>, <span class='no'>year</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span>(<span class='kw'>part_seg</span> <span class='kw'>=</span> <span class='fu'>sum</span>(<span class='no'>participants</span>)),
)</div><div class='output co'>#&gt; <span class='message'>Joining, by = "year"</span></div><div class='output co'>#&gt; # A tibble: 11 x 3
#&gt;     year part_tot part_seg
#&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
#&gt;  1  2008     6393     6285
#&gt;  2  2009     7591     7475
#&gt;  3  2010     7775     7632
#&gt;  4  2011     7819     7679
#&gt;  5  2012     8243     8100
#&gt;  6  2013     8273     8136
#&gt;  7  2014     8970     8815
#&gt;  8  2015     9086     8959
#&gt;  9  2016     9161     9011
#&gt; 10  2017     9389     9253
#&gt; 11  2018     9206     9059</div><div class='input'>
<span class='co'># perform scaling</span>
<span class='no'>part_segment</span> <span class='kw'>&lt;-</span> <span class='fu'>scaleup_part</span>(<span class='no'>part_segment</span>, <span class='no'>part_total</span>)
<span class='fu'><a href='https://dplyr.tidyverse.org/reference/join.html'>left_join</a></span>(
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span>(<span class='no'>part_total</span>, <span class='no'>year</span>, <span class='kw'>part_tot</span> <span class='kw'>=</span> <span class='no'>participants</span>),
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>part_segment</span>, <span class='no'>year</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span>(<span class='kw'>part_seg</span> <span class='kw'>=</span> <span class='fu'>sum</span>(<span class='no'>participants</span>)),
)</div><div class='output co'>#&gt; <span class='message'>Joining, by = "year"</span></div><div class='output co'>#&gt; # A tibble: 11 x 3
#&gt;     year part_tot part_seg
#&gt;    &lt;int&gt;    &lt;int&gt;    &lt;int&gt;
#&gt;  1  2008     6393     6393
#&gt;  2  2009     7591     7591
#&gt;  3  2010     7775     7775
#&gt;  4  2011     7819     7819
#&gt;  5  2012     8243     8243
#&gt;  6  2013     8273     8273
#&gt;  7  2014     8970     8970
#&gt;  8  2015     9086     9086
#&gt;  9  2016     9161     9161
#&gt; 10  2017     9389     9389
#&gt; 11  2018     9206     9206</div><div class='input'>
<span class='co'># new recruits - unscaled</span>
<span class='no'>history_new</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>history</span>, <span class='no'>R3</span> <span class='kw'>==</span> <span class='st'>"Recruit"</span>)
<span class='no'>part_total</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='est_part.html'>est_recruit</a></span>(<span class='no'>history_new</span>, <span class='st'>"tot"</span>)
<span class='no'>part_segment</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='est_part.html'>est_recruit</a></span>(<span class='no'>history_new</span>, <span class='st'>"sex"</span>)
<span class='no'>part_segment</span></div><div class='output co'>#&gt; # A tibble: 12 x 3
#&gt;    sex     year recruits
#&gt;    &lt;fct&gt;  &lt;int&gt;    &lt;int&gt;
#&gt;  1 Male    2013     1383
#&gt;  2 Male    2014     1653
#&gt;  3 Male    2015     1675
#&gt;  4 Male    2016     1670
#&gt;  5 Male    2017     1638
#&gt;  6 Male    2018     1460
#&gt;  7 Female  2013      534
#&gt;  8 Female  2014      631
#&gt;  9 Female  2015      704
#&gt; 10 Female  2016      713
#&gt; 11 Female  2017      661
#&gt; 12 Female  2018      586</div><div class='input'>
<span class='co'># new recruits - scaled</span>
<span class='fu'>scaleup_recruit</span>(<span class='no'>part_segment</span>, <span class='no'>part_total</span>)</div><div class='output co'>#&gt; # A tibble: 12 x 3
#&gt;    sex     year recruits
#&gt;    &lt;fct&gt;  &lt;int&gt;    &lt;int&gt;
#&gt;  1 Male    2013     1413
#&gt;  2 Male    2014     1686
#&gt;  3 Male    2015     1697
#&gt;  4 Male    2016     1696
#&gt;  5 Male    2017     1658
#&gt;  6 Male    2018     1490
#&gt;  7 Female  2013      546
#&gt;  8 Female  2014      644
#&gt;  9 Female  2015      713
#&gt; 10 Female  2016      724
#&gt; 11 Female  2017      669
#&gt; 12 Female  2018      598</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.southwickassociates.com/our-staff/dan-kary/'>Dan Kary</a>, <a href='https://www.southwickassociates.com'><img src='man/figures/sa.jpg' alt='Southwick Associates' height='30'/></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

